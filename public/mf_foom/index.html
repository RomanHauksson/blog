<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>üé§ MF FOOM: AI-generated MF DOOM songs | Roman Hauksson</title><meta name=keywords content="ü§ñ artificial intelligence"><meta name=description content="I fine-tuned GPT-3 on the lyrics of 96 MF DOOM songs to write lyrics in his style. Then, i cloned his voice to a text-to-voice model to make him rap them."><meta name=author content><link rel=canonical href=https://roman.computer/MF_FOOM><link crossorigin=anonymous href=/assets/css/stylesheet.855e48320613a3e8fc0ca0ac97a03a5c8da75978d3f5e325dc8e2dd8f8b5c146.css integrity="sha256-hV5IMgYTo+j8DKCsl6A6XI2nWXjT9eMl3I4t2Pi1wUY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://hugo.roman.computer/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hugo.roman.computer/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hugo.roman.computer/favicon-32x32.png><link rel=apple-touch-icon href=https://hugo.roman.computer/apple-touch-icon.png><link rel=mask-icon href=https://hugo.roman.computer/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css integrity=sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js integrity=sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><meta property="og:title" content="üé§ MF FOOM: AI-generated MF DOOM songs"><meta property="og:description" content="I fine-tuned GPT-3 on the lyrics of 96 MF DOOM songs to write lyrics in his style. Then, i cloned his voice to a text-to-voice model to make him rap them."><meta property="og:type" content="article"><meta property="og:url" content="https://hugo.roman.computer/mf_foom/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2023-07-01T00:00:00+00:00"><meta property="og:site_name" content="Roman Hauksson"><meta name=twitter:card content="summary"><meta name=twitter:title content="üé§ MF FOOM: AI-generated MF DOOM songs"><meta name=twitter:description content="I fine-tuned GPT-3 on the lyrics of 96 MF DOOM songs to write lyrics in his style. Then, i cloned his voice to a text-to-voice model to make him rap them."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hugo.roman.computer/posts/"},{"@type":"ListItem","position":2,"name":"üé§ MF FOOM: AI-generated MF DOOM songs","item":"https://hugo.roman.computer/mf_foom/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"üé§ MF FOOM: AI-generated MF DOOM songs","name":"üé§ MF FOOM: AI-generated MF DOOM songs","description":"I fine-tuned GPT-3 on the lyrics of 96 MF DOOM songs to write lyrics in his style. Then, i cloned his voice to a text-to-voice model to make him rap them.","keywords":["ü§ñ artificial intelligence"],"articleBody":" I wanted to recreate MF DOOM's prose not only because he's my favorite artist but also because it's famously dense with rhyme, wordplay, and pop culture references. ChatGPT can already generate lyrics as ‚Äúcomplex‚Äù as Lil Pump‚Äôs using zero-shot prompting, but is it possible to use more sophisticated methods to coax a language model into generating lyrics of MF DOOM's caliber?\ndemo Unfortunately, even with fine-tuning, MF FOOM doesn‚Äôt quite match DOOM's wordsmithery.\nExample input prompt:\nA song titled \"Metal Mask\" about the story of how MF DOOM obtained his iconic metal mask and the power it gives him in the rap game.\nFinal output song:\nLyrics:\nMetal mask give him bad brains, pain man can't explain\nGot locked up like a zoo monkey, then poof! Freedom\nGot loose, left the cell, started rockin fools clean\nLike a hill of beans, beans, no pan dulce\nThe rap game is like the seventh seal, it's so real\nHe hide behind a mask like a child, it's cold steel\nNo regrets, he do what he gotta and he peep this\nI hold this, zap! Straight out the box, no joke\nDeadly as a runaway stampede or lightning bolt in Summertime\nBig as a Bumblebee sting and quicker to bring strife\nThrough the big speakers, sound bombs, ignite drama\nOn my A-game, I be straight sniper, through your eye likeGrey's\nAnatomy\nWhite chick that be in the show with all them doctors\nKnow what I'm saying? The name control the ball like gridiron\nSpeech, diction, syntax is triple A rated\nAnd it's not how he talk it, who he talk to\nTo all y'all that hate, keep your mouth closed\n(DOOM!) Watch the mask and you'll see\nAnd say your prayers, like \"Boom! He's back!\"\nYou won't see me, I disappear like Dr. Jekyll and Mr. Hyde\nBoogie blow, snatch the dough then split like Houdini\nLike a palm tree in Africa, can't stand still\nWith the metal mask, give him mad-r'dic skills\nLike Kung Fu, uncanny too and always get it poppin'\nAlways gone, always goon, on the road that's how it seem\nSeriously, he be writing on the tour like Forrest Gump\nWent to dinner with the 'mentor', it was crazy dude\nHe gave him advice, he told him what life was about\nWe got beef with Jim Crow and don't forget\nThe name is DOOM, the mask gives him powers\nCompare that to the first few lines of DOOM's All Caps:\nSo nasty that it's probably somewhat of a travesty having me\nDaily told the people \"You can call me Your Majesty!\"\nKeep your battery charged\nYou know it won't stick, yo\nAnd it's not his fault you kick slow\nShould've let your trick 'ho chick hold your sick glow\nPlus nobody couldn't do nothin' once he let the brick go\ntechnical process grabbing DOOM‚Äôs lyrics I started by downloading the lyrics of every DOOM song from Genius (a website where users transcribe and annotate song lyrics) using the LyricsGenius Python library.\nfrom lyricsgenius import Genius import os import re token = os.getenv(\"GENIUS_API_KEY\") genius = Genius(token) # If the song title contains any of these words, it will be excluded from the # results. genius.excluded_terms = [\"remix\", \"mix\", \"live\", \"instrumental\"] artist = genius.search_artist(\"MF DOOM\") # Clean up the lyrics. songs = {} for song in artist.songs: songLyrics = re.sub(r'^\\d* Contributors?.* Lyrics', '', song.lyrics) songLyrics = re.sub(r'You might also like', '', songLyrics) songLyrics = re.sub(r'\\d*Embed', '', songLyrics) songs[song.title] = songLyrics songs Searching for songs by MF DOOM... Song 1: \"Doomsday\" Song 2: \"Beef Rapp\" Song 3: \"Rapp Snitch Knishes\" Song 4: \"One Beer\" ... Done. {'Doomsday': '[Intro: Pebbles the Invisible Girl, MF DOOM]\\nMic Check\\nWhen I was... 'Beef Rapp': '[Produced by Metal Fingers]\\n\\n[Skit 1]\\nNow I haven\\'t eaten a... 'Rapp Snitch Knishes': '[Intro: Mr. Fantastik \u0026 MF DOOM]\\nYo! Yo!\\nMF DOOM, M... 'One Beer': '[Intro]\\nI get no kick from champagne\\nMere alcohol doesn\\'t thr... fine-tuning GPT-3 I used the ChatGPT API to generate one-sentence summaries of each song. These are used to create a list of prompt‚Äìcompletion pairs for fine-tuning a different model, using OpenAI‚Äôs recommendations for formatting best practices:\n{ \"prompt\": \"\\n\\n###\\n\\n\", \"completion\": \" \\nEND OF SONG\" } import openai import jsonlines openai.organization = os.getenv(\"OPENAI_ORG\") openai.api_key = os.getenv(\"OPENAI_API_KEY\") prompts = [] for title, lyrics in songs.items(): if lyrics == \"\" or lyrics == None: continue response = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[ {\"role\": \"system\", \"content\": \"You are a helpful assistant who is an expert on pop culture, and specifically the history of hip hop.\"}, {\"role\": \"user\", \"content\": 'Please give a one-sentence summary of the following song. Your response should follow this format: \"A song about .\". Here are the lyrics:\\n\\n\"\"\"\\n' + lyrics + '\"\"\"'}, ] ) description = response['choices'][0]['message']['content'] description = re.sub(r'^A song about ', '', description) description = f'A song titled \"{title}\" about {description}' prompts.append({ \"prompt\": description + \"\\n\\n###\\n\\n\", \"completion\": \" \" + lyrics + \"\\nEND OF SONG\" }) # Write the prompt-completion pairs to a JSON Lines file. with jsonlines.open('prompts.jsonl', mode='w') as writer: writer.write_all(prompts) prompts[0] {'prompt': 'A song titled \"Doomsday\" about the power and impact of an MC, their unique and influential voice in the world of hip hop.\\n\\n###\\n\\n', 'completion': ' [Intro: Pebbles the Invisible Girl, MF DOOM]\\nMic Check\\nWhen I was led to you\\nI knew you were the one for me... \\nEND OF SONG'} I then fine-tuned a GPT-3 DaVinci model using the song lyrics and summaries. I had to wait in line to fine-tune my mode for hours, even though the fine-tuning process itself took just five minutes.\n!openai api fine_tunes.create -t prompts.jsonl -m davinci making him sing After the model was finished fine-tuning, MF FOOM had a pen! I put him to work with his first song, Metal Mask.\ndef songDescriptionToLyrics(description): prompt = description + \"\\n\\n###\\n\\n\" # Retrieve the ID of the latest fine-tuned model you've created. model = dict(openai.FineTune.list())['data'][-1][\"fine_tuned_model\"] if model == None: raise Exception(\"The fine-tuning job probably hasn't finished yet.\") completion = openai.Completion.create( model=model, prompt=prompt, max_tokens=1300, temperature=0.9, presence_penalty=0.46, stop=\"END OF SONG\" ) return completion['choices'][0]['text'] print(songDescriptionToLyrics('A song titled \"Metal Mask\" about the story of how MF DOOM obtained his iconic metal mask and the power it gives him in the rap game.')) Metal mask give him bad brains, pain man can\\'t explain Got locked up like a zoo monkey, then poof! Freedom Got loose, left the cell, started rockin fools clean Like a hill of beans, beans, no pan dulce The rap game is like the seventh seal, it\\'s so real ... I then used ElevenLabs to give him a voice. This a service which enables you to generate incredibly realistic text-to-voice audio clips, and one of its features is the ability to clone someone's voice from an existing audio clip and get the resulting voice engine to read out loud any new text you want.\nI cloned DOOM's voice from the acapella version of Gazzillion Ear, then generated the vocals for Metal Mask using the clone with a \"stability\" value of 86% and a \"similarity\" value of 100%. Finally, i used GarageBand to overlay the vocals onto the instrumental of Gazzillion Ear.\nHe doesn't sound exactly like DOOM, and his flow is off-beat, even after i played around with quantization. Oh well. He's still a better rapper than me.\nThe lyrics i generated and the final song Metal Mask are a non-commercial parody.\n","wordCount":"1215","inLanguage":"en","datePublished":"2023-07-01T00:00:00Z","dateModified":"2023-07-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://hugo.roman.computer/mf_foom/"},"publisher":{"@type":"Organization","name":"Roman Hauksson","logo":{"@type":"ImageObject","url":"https://hugo.roman.computer/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hugo.roman.computer/ accesskey=h title="Roman Hauksson (Alt + H)">Roman Hauksson</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<img src=/sun.png id=sun class=theme-toggle-icon>
<img src=/moon.png id=moon class=theme-toggle-icon></button></div></div><ul id=menu><li><a class=link href=https://hugo.roman.computer/posts/ title=posts><span>posts</span></a></li><li><a class=link href=https://hugo.roman.computer/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hugo.roman.computer/>Home</a>&nbsp;¬ª&nbsp;<a href=https://hugo.roman.computer/posts/>Posts</a></div><h1 class=post-title>üé§ MF FOOM: AI-generated MF DOOM songs</h1><div class=post-description>I fine-tuned GPT-3 on the lyrics of 96 MF DOOM songs to write lyrics in his style. Then, i cloned his voice to a text-to-voice model to make him rap them.</div><div class=post-meta><span title='2023-07-01 00:00:00 +0000 UTC'>2023 Jul 1</span>&nbsp;¬∑&nbsp;6 min</div><ul class=post-tags><li><a class=post-tag href=https://hugo.roman.computer/tags/artificial-intelligence/>ü§ñ artificial intelligence</a></li></ul></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>table of contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#demo>demo</a></li><li><a href=#technical-process>technical process</a><ul><li><a href=#grabbing-dooms-lyrics>grabbing DOOM&rsquo;s lyrics</a></li><li><a href=#fine-tuning-gpt-3>fine-tuning GPT-3</a></li><li><a href=#making-him-sing>making him sing</a></li></ul></li></ul></nav></div></details></div><div class=post-content><div class="cell markdown" markdown=1><p>I wanted to recreate <a href=https://en.wikipedia.org/wiki/MF_Doom>MF DOOM</a>'s prose not only because he's my favorite
artist but also because it's famously dense with rhyme, wordplay, and
pop culture references. ChatGPT can already generate lyrics as &ldquo;complex&rdquo; as <a href=https://en.wikipedia.org/wiki/Lil_Pump>Lil
Pump</a>&rsquo;s using <a href=https://www.promptingguide.ai/techniques/zeroshot>zero-shot prompting</a>, but is it possible to use more
sophisticated methods to coax a language model into generating lyrics of
MF DOOM's caliber?</p><h2 id=demo>demo<a hidden class=anchor aria-hidden=true href=#demo>#</a></h2><p>Unfortunately, even with fine-tuning, MF FOOM doesn&rsquo;t quite
match DOOM's wordsmithery.</p><p>Example input prompt:</p><blockquote><p>A song titled "Metal Mask" about the story of how MF DOOM obtained
his iconic metal mask and the power it gives him in the rap game.</p></blockquote><p>Final output song:</p><audio controls><source src=https://user-images.githubusercontent.com/62364808/232918506-4b40215b-728b-4879-9631-8c5107e28855.mp4 type=video/mp4></audio><p>Lyrics:</p><blockquote><p>Metal mask give him bad brains, pain man can't explain<br>Got locked up like a zoo monkey, then poof! Freedom<br>Got loose, left the cell, started rockin fools clean<br>Like a hill of beans, beans, no pan dulce<br>The rap game is like the seventh seal, it's so real<br>He hide behind a mask like a child, it's cold steel<br>No regrets, he do what he gotta and he peep this<br>I hold this, zap! Straight out the box, no joke<br>Deadly as a runaway stampede or lightning bolt in Summertime<br>Big as a Bumblebee sting and quicker to bring strife<br>Through the big speakers, sound bombs, ignite drama<br>On my A-game, I be straight sniper, through your eye likeGrey's<br>Anatomy<br>White chick that be in the show with all them doctors<br>Know what I'm saying? The name control the ball like gridiron<br>Speech, diction, syntax is triple A rated<br>And it's not how he talk it, who he talk to<br>To all y'all that hate, keep your mouth closed<br>(DOOM!) Watch the mask and you'll see<br>And say your prayers, like "Boom! He's back!"<br>You won't see me, I disappear like Dr. Jekyll and Mr. Hyde<br>Boogie blow, snatch the dough then split like Houdini<br>Like a palm tree in Africa, can't stand still<br>With the metal mask, give him mad-r'dic skills<br>Like Kung Fu, uncanny too and always get it poppin'<br>Always gone, always goon, on the road that's how it seem<br>Seriously, he be writing on the tour like Forrest Gump<br>Went to dinner with the 'mentor', it was crazy dude<br>He gave him advice, he told him what life was about<br>We got beef with Jim Crow and don't forget<br>The name is DOOM, the mask gives him powers</p></blockquote><p>Compare that to the first few lines of <a href=https://genius.com/Madvillain-all-caps-lyrics>DOOM's <em>All Caps</em></a>:</p><blockquote><p>So nasty that it's probably somewhat of a travesty having me<br>Daily told the people "You can call me Your Majesty!"<br>Keep your battery charged<br>You know it won't stick, yo<br>And it's not his fault you kick slow<br>Should've let your trick 'ho chick hold your sick glow<br>Plus nobody couldn't do nothin' once he let the brick go</p></blockquote></div><div class="cell markdown" markdown=1><h2 id=technical-process>technical process<a hidden class=anchor aria-hidden=true href=#technical-process>#</a></h2><h3 id=grabbing-dooms-lyrics>grabbing DOOM&rsquo;s lyrics<a hidden class=anchor aria-hidden=true href=#grabbing-dooms-lyrics>#</a></h3><p>I started by downloading the lyrics of every DOOM song from
<a href=https://genius.com/>Genius</a> (a website where users transcribe and
annotate song lyrics) using the
<a href=https://lyricsgenius.readthedocs.io/en/master/>LyricsGenius</a> Python
library.</p></div><div class="cell code" markdown=1 execution_count=55><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>lyricsgenius</span> <span class=kn>import</span> <span class=n>Genius</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>token</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;GENIUS_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>genius</span> <span class=o>=</span> <span class=n>Genius</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If the song title contains any of these words, it will be excluded from the</span>
</span></span><span class=line><span class=cl><span class=c1># results.</span>
</span></span><span class=line><span class=cl><span class=n>genius</span><span class=o>.</span><span class=n>excluded_terms</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;remix&#34;</span><span class=p>,</span> <span class=s2>&#34;mix&#34;</span><span class=p>,</span> <span class=s2>&#34;live&#34;</span><span class=p>,</span> <span class=s2>&#34;instrumental&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>artist</span> <span class=o>=</span> <span class=n>genius</span><span class=o>.</span><span class=n>search_artist</span><span class=p>(</span><span class=s2>&#34;MF DOOM&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Clean up the lyrics.</span>
</span></span><span class=line><span class=cl><span class=n>songs</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>song</span> <span class=ow>in</span> <span class=n>artist</span><span class=o>.</span><span class=n>songs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>songLyrics</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^\d* Contributors?.* Lyrics&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>song</span><span class=o>.</span><span class=n>lyrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>songLyrics</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;You might also like&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>songLyrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>songLyrics</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\d*Embed&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>songLyrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>songs</span><span class=p>[</span><span class=n>song</span><span class=o>.</span><span class=n>title</span><span class=p>]</span> <span class=o>=</span> <span class=n>songLyrics</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>songs</span>
</span></span></code></pre></div><div class="output stream stdout" markdown=1><pre tabindex=0><code class=language-terminal data-lang=terminal>Searching for songs by MF DOOM...

Song 1: &#34;Doomsday&#34;
Song 2: &#34;Beef Rapp&#34;
Song 3: &#34;Rapp Snitch Knishes&#34;
Song 4: &#34;One Beer&#34;
...

Done.
</code></pre></div><div class="output execute_result" markdown=1 execution_count=55><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=err>&#39;Doomsday&#39;:</span> <span class=err>&#39;[Intro:</span> <span class=err>Pebbles</span> <span class=err>the</span> <span class=err>Invisible</span> <span class=err>Girl,</span> <span class=err>MF</span> <span class=err>DOOM]\nMic</span> <span class=err>Check\nWhen</span> <span class=err>I</span> <span class=err>was...</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;Beef</span> <span class=err>Rapp&#39;:</span> <span class=err>&#39;[Produced</span> <span class=err>by</span> <span class=err>Metal</span> <span class=err>Fingers]\n\n[Skit</span> <span class=err>1]\nNow</span> <span class=err>I</span> <span class=err>haven\&#39;t</span> <span class=err>eaten</span> <span class=err>a...</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;Rapp</span> <span class=err>Snitch</span> <span class=err>Knishes&#39;:</span> <span class=err>&#39;[Intro:</span> <span class=err>Mr.</span> <span class=err>Fantastik</span> <span class=err>&amp;</span> <span class=err>MF</span> <span class=err>DOOM]\nYo!</span> <span class=err>Yo!\nMF</span> <span class=err>DOOM,</span> <span class=err>M...</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;One</span> <span class=err>Beer&#39;:</span> <span class=err>&#39;[Intro]\nI</span> <span class=err>get</span> <span class=err>no</span> <span class=err>kick</span> <span class=err>from</span> <span class=err>champagne\nMere</span> <span class=err>alcohol</span> <span class=err>doesn\&#39;t</span> <span class=err>thr...</span>
</span></span></code></pre></div></div></div><div class="cell markdown" markdown=1><h3 id=fine-tuning-gpt-3>fine-tuning GPT-3<a hidden class=anchor aria-hidden=true href=#fine-tuning-gpt-3>#</a></h3><p>I used the ChatGPT API to generate one-sentence summaries of each
song. These are used to create a list of prompt&ndash;completion pairs for
fine-tuning a different model, using <a href=https://platform.openai.com/docs/guides/fine-tuning/preparing-your-dataset>OpenAI&rsquo;s recommendations</a> for formatting best practices:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;prompt&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;song summary&gt;\n\n###\n\n&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;completion&#34;</span><span class=p>:</span> <span class=s2>&#34; &lt;song lyrics&gt;\nEND OF SONG&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><div class="cell code" markdown=1 execution_count=56><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>openai</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jsonlines</span>
</span></span><span class=line><span class=cl><span class=n>openai</span><span class=o>.</span><span class=n>organization</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;OPENAI_ORG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>openai</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;OPENAI_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prompts</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>title</span><span class=p>,</span> <span class=n>lyrics</span> <span class=ow>in</span> <span class=n>songs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>lyrics</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span> <span class=ow>or</span> <span class=n>lyrics</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>openai</span><span class=o>.</span><span class=n>ChatCompletion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=s2>&#34;gpt-3.5-turbo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;You are a helpful assistant who is an expert on pop culture, and specifically the history of hip hop.&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=s1>&#39;Please give a one-sentence summary of the following song. Your response should follow this format: &#34;A song about &lt;description&gt;.&#34;. Here are the lyrics:</span><span class=se>\n\n</span><span class=s1>&#34;&#34;&#34;</span><span class=se>\n</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>lyrics</span> <span class=o>+</span> <span class=s1>&#39;&#34;&#34;&#34;&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s1>&#39;choices&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;message&#39;</span><span class=p>][</span><span class=s1>&#39;content&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^A song about &#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>description</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;A song titled &#34;</span><span class=si>{</span><span class=n>title</span><span class=si>}</span><span class=s1>&#34; about </span><span class=si>{</span><span class=n>description</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>prompts</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;prompt&#34;</span><span class=p>:</span> <span class=n>description</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>###</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;completion&#34;</span><span class=p>:</span> <span class=s2>&#34; &#34;</span> <span class=o>+</span> <span class=n>lyrics</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>END OF SONG&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Write the prompt-completion pairs to a JSON Lines file.</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>jsonlines</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;prompts.jsonl&#39;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>writer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>writer</span><span class=o>.</span><span class=n>write_all</span><span class=p>(</span><span class=n>prompts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prompts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span></code></pre></div><div class="output execute_result" markdown=1 execution_count=56><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=err>&#39;prompt&#39;:</span> <span class=err>&#39;A</span> <span class=err>song</span> <span class=err>titled</span> <span class=nt>&#34;Doomsday&#34;</span> <span class=err>about</span> <span class=err>the</span> <span class=err>power</span> <span class=err>and</span> <span class=err>impact</span> <span class=err>of</span> <span class=err>an</span> <span class=err>MC</span><span class=p>,</span> <span class=err>their</span> <span class=err>unique</span> <span class=err>and</span> <span class=err>influential</span> <span class=err>voice</span> <span class=err>in</span> <span class=err>the</span> <span class=err>world</span> <span class=err>of</span> <span class=err>hip</span> <span class=err>hop.\n\n###\n\n&#39;,</span>
</span></span><span class=line><span class=cl><span class=err>&#39;completion&#39;:</span> <span class=err>&#39;</span> <span class=err>[Intro:</span> <span class=err>Pebbles</span> <span class=err>the</span> <span class=err>Invisible</span> <span class=err>Girl,</span> <span class=err>MF</span> <span class=err>DOOM]\nMic</span> <span class=err>Check\nWhen</span> <span class=err>I</span> <span class=err>was</span> <span class=err>led</span> <span class=err>to</span> <span class=err>you\nI</span> <span class=err>knew</span> <span class=err>you</span> <span class=err>were</span> <span class=err>the</span> <span class=err>one</span> <span class=err>for</span> <span class=err>me...</span> <span class=err>\nEND</span> <span class=err>OF</span> <span class=err>SONG&#39;</span><span class=p>}</span>
</span></span></code></pre></div></div></div><div class="cell markdown" markdown=1><p>I then fine-tuned a GPT-3 DaVinci model using the song lyrics and
summaries. I had to wait in line to fine-tune my mode for hours, even
though the fine-tuning process itself took just five minutes.</p></div><div class="cell code" markdown=1 execution_count=57><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=err>!</span><span class=n>openai</span> <span class=n>api</span> <span class=n>fine_tunes</span><span class=o>.</span><span class=n>create</span> <span class=o>-</span><span class=n>t</span> <span class=n>prompts</span><span class=o>.</span><span class=n>jsonl</span> <span class=o>-</span><span class=n>m</span> <span class=n>davinci</span>
</span></span></code></pre></div></div><div class="cell markdown" markdown=1><h3 id=making-him-sing>making him sing<a hidden class=anchor aria-hidden=true href=#making-him-sing>#</a></h3><p>After the model was finished fine-tuning, MF FOOM had a pen! I put him to work with his first song, <em>Metal
Mask</em>.</p></div><div class="cell code" markdown=1 execution_count=59><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>songDescriptionToLyrics</span><span class=p>(</span><span class=n>description</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>prompt</span> <span class=o>=</span> <span class=n>description</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>###</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Retrieve the ID of the latest fine-tuned model you&#39;ve created.</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>openai</span><span class=o>.</span><span class=n>FineTune</span><span class=o>.</span><span class=n>list</span><span class=p>())[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=s2>&#34;fine_tuned_model&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>model</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;The fine-tuning job probably hasn&#39;t finished yet.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>completion</span> <span class=o>=</span> <span class=n>openai</span><span class=o>.</span><span class=n>Completion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>prompt</span><span class=o>=</span><span class=n>prompt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>max_tokens</span><span class=o>=</span><span class=mi>1300</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>temperature</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>presence_penalty</span><span class=o>=</span><span class=mf>0.46</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>stop</span><span class=o>=</span><span class=s2>&#34;END OF SONG&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>completion</span><span class=p>[</span><span class=s1>&#39;choices&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;text&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>songDescriptionToLyrics</span><span class=p>(</span><span class=s1>&#39;A song titled &#34;Metal Mask&#34; about the story of how MF DOOM obtained his iconic metal mask and the power it gives him in the rap game.&#39;</span><span class=p>))</span>
</span></span></code></pre></div><div class="output stream stdout" markdown=1><pre tabindex=0><code class=language-terminal data-lang=terminal>Metal mask give him bad brains, pain man can\&#39;t explain
Got locked up like a zoo monkey, then poof! Freedom
Got loose, left the cell, started rockin fools clean
Like a hill of beans, beans, no pan dulce
The rap game is like the seventh seal, it\&#39;s so real
...
</code></pre></div></div><div class="cell markdown" markdown=1><p>I then used <a href=https://beta.elevenlabs.io/>ElevenLabs</a> to give him a voice. This a service which enables you
to generate incredibly realistic text-to-voice audio clips, and one of
its features is the ability to clone someone's voice from an existing
audio clip and get the resulting voice engine to read out loud any new
text you want.</p><p>I cloned DOOM's voice from <a href="https://www.youtube.com/watch?v=LoXJd4Hkbcg">the acapella version of
<em>Gazzillion Ear</em></a>, then
generated the vocals for <em>Metal Mask</em> using the clone with a
"stability" value of 86% and a "similarity" value of 100%. Finally,
i used GarageBand to overlay the vocals onto <a href="https://www.youtube.com/watch?v=sQ7aKsYxwaM">the instrumental of
<em>Gazzillion Ear</em></a>.</p><audio controls><source src=https://user-images.githubusercontent.com/62364808/232918506-4b40215b-728b-4879-9631-8c5107e28855.mp4 type=video/mp4></audio><p>He doesn't sound <em>exactly</em> like DOOM, and his flow is off-beat, even
after i played around with
<a href=https://en.wikipedia.org/wiki/Quantization_(music)>quantization</a>. Oh
well. He's still a better rapper than
<a href=https://soundcloud.com/roman-hauksson-neill>me</a>.</p><p><em>The lyrics i generated and the final song Metal Mask are a
non-commercial parody.</em></p></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://hugo.roman.computer/password_security/><span class=title>¬´ Prev</span><br><span>üîë a talk about password security</span></a>
<a class=next href=https://hugo.roman.computer/local_ai_regulation/><span class=title>Next ¬ª</span><br><span>‚öñÔ∏è local regulation of artificial intelligence in the US</span></a></nav></footer></article></main><footer class=footer><span><a href=https://creativecommons.org/licenses/by-sa/4.0/>(…î) CC BY-SA</a> ‚Ä¢
<a href=https://github.com/RomanHauksson/blog>source code</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML='<img src="/copy.png"/>';function s(){t.innerHTML='<img src="/copied.png"/>',setTimeout(()=>{t.innerHTML='<img src="/copy.png"/>'},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>